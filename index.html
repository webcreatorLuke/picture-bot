<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Funny Camera</title>
<style>
    body {
        background: #111;
        color: #fff;
        font-family: Arial;
        text-align: center;
        padding: 20px;
    }
    video, canvas {
        width: 90%;
        max-width: 450px;
        border-radius: 12px;
        margin-top: 15px;
        background: #000;
    }
    button {
        margin-top: 15px;
        padding: 10px 20px;
        font-size: 18px;
        border-radius: 10px;
        border: none;
        cursor: pointer;
        background: #ff3b3b;
        color: white;
        font-weight: bold;
    }
</style>
</head>
<body>

<h2>ðŸ˜‚ Funny Selfie Camera</h2>
<p>Camera turns on automatically. Take a pic & get a funny version!</p>

<video id="video" autoplay playsinline></video>
<button id="snapBtn">Take Funny Photo</button>
<canvas id="canvas"></canvas>

<script>
const video = document.getElementById("video");
const canvas = document.getElementById("canvas");
const ctx = canvas.getContext("2d");

// TURN CAMERA ON AUTOMATICALLY âœ”ï¸
async function startCamera() {
    try {
        const stream = await navigator.mediaDevices.getUserMedia({
            video: { facingMode: "user" }
        });
        video.srcObject = stream;
    } catch (err) {
        alert("Camera failed: " + err);
    }
}
startCamera();

// TAKE PHOTO + APPLY FUNNY EFFECT âœ”ï¸
document.getElementById("snapBtn").addEventListener("click", () => {
    const w = video.videoWidth;
    const h = video.videoHeight;

    canvas.width = w;
    canvas.height = h;

    ctx.drawImage(video, 0, 0, w, h);

    // Get pixels
    let imgData = ctx.getImageData(0, 0, w, h);
    let d = imgData.data;

    // FUNNY EFFECT: Big-mouth + Warp Face ðŸ˜‚
    for (let y = 0; y < h; y++) {
        for (let x = 0; x < w; x++) {

            let dx = x - w/2;
            let dy = y - h/2;
            let dist = Math.sqrt(dx*dx + dy*dy);

            // Warp strength
            if (dist < h * 0.35) {
                let warp = 1 + (0.4 * (1 - dist / (h * 0.35)));
                let sx = Math.floor(w/2 + dx * warp);
                let sy = Math.floor(h/2 + dy * warp);

                if (sx >= 0 && sx < w && sy >= 0 && sy < h) {
                    let srcIndex = (sy * w + sx) * 4;
                    let dstIndex = (y * w + x) * 4;

                    d[dstIndex] = d[srcIndex];
                    d[dstIndex+1] = d[srcIndex+1];
                    d[dstIndex+2] = d[srcIndex+2];
                }
            }
        }
    }

    ctx.putImageData(imgData, 0, 0);
});
</script>

</body>
</html>
